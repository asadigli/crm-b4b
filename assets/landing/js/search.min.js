import{l,paginateController,getUrlParameter,filter_url,$_get,$db,hdKey}from"./parts.min.js?v=1a";import{productComponent,filterCheckboxSection}from"./components.min.js?v=1abc";import{Screen}from"./current_screen.min.js?v=1";const filterList=(e,t)=>{$db.on("keyup search",`[data-role="${e}"]`,function(){let e=$(`[data-role="${t}"]`).find("label"),r=$(this).val().toLowerCase();e.each(function(){let e=$(this).find('[data-role="title"]');e.text().toLowerCase().includes(r)?e.parents("label").removeClass("d-none"):e.parents("label").addClass("d-none")})})},array_unique=(e,t,r)=>r.indexOf(e)===t,removeItemAll=(e,t)=>{for(var r=0;r<e.length;)e[r]===t?e.splice(r,1):++r;return e};$(function(){let e=getUrlParameter("keyword")||"",t=getUrlParameter("brands")||"",r=getUrlParameter("group")||"",o=getUrlParameter("categories")||"",a=getUrlParameter("second-categories")||"",i=getUrlParameter("page")||"",s=$("#search_products"),c=0,d=e=>{$("input:not(:disabled),select:not(:disabled)").prop("disabled",!0).addClass("fbc_disabled"),$.get({url:"/search/get-brands",data:{group_id:e},headers:hdKey,success:function(e){let r=e.data,l=r.brand?r.brand.map(e=>filterCheckboxSection(e.id,e.name,t)).join(" "):"",i=r.category?r.category.map(e=>filterCheckboxSection(e.id,e.name,o)).join(" "):"",s=r.second_category?r.second_category.map(e=>filterCheckboxSection(e.id,e.name,a)).join(" "):"";$('[data-role="filter-brand-list"]').html(l),$('[data-role="filter-category-list"]').html(i),$('[data-role="filter-second-category-list"]').html(s),filterList("filter-brand-search","filter-brand-list"),filterList("filter-category-search","filter-category-list"),filterList("filter-second-category-search","filter-second-category-list"),filterList("mb-filter-brand-search","mb-filter-brand-list"),filterList("mb-filter-category-search","mb-filter-category-list"),filterList("mb-filter-second-category-search","mb-filter-second-category-list")},error:function(e){console.error(e)},complete:function(){$("input.fbc_disabled,select.fbc_disabled").prop("disabled",!1).removeClass("fbc_disabled"),$('[role="product-filter"]').removeClass("load"),$('[data-role="filter-brand-search"],[data-role="filter-category-search"],[data-role="filter-second-category-search"]').parent().removeClass("load")}})};d(r),$db.on("change",'[name="mb-product-group"],[name="product-group"]',function(){r=$(this).data("val")+"",t="",o="",a="",filter_url([{page:i},{keyword:e},{group:r||""},{brands:t},{categories:o},{"second-categories":a}]),d(r),n(i,{keyword:e,filt_brands:t,filt_group:r,filt_categories:o,filt_2nd_categories:a},!0)}),$db.on("click",'[data-role="reset-filter"]',function(){e="",r="",t="",o="",a="",$('[name="mb-product-group"],[name="product-group"]').prop("checked",!1),$('[name="mb-product-group"]').eq(0).prop("checked",!0),$('[name="product-group"]').eq(0).prop("checked",!0),filter_url([{page:i},{keyword:e},{group:r||""},{brands:t},{categories:o},{"second-categories":a}]),d(r),n(i,{keyword:e,filt_brands:t,filt_group:r,filt_categories:o,filt_2nd_categories:a},!0),$("html, body").animate({scrollTop:s.offset().top-130},"slow")});let n=(e,t,r)=>{s.addClass("load"),t.keyword&&$('[data-role="product-search"]').val(t.keyword);let o=Object.assign(t,{page:e});$("input:not([disabled])").addClass("disabled-auto").prop("disabled",!0),$.get({url:"/search/live",headers:hdKey,cache:!0,data:o,success:function(t){let o="";l("No_result_found");t.products&&t.products.map(e=>{o+=`<div class="col-lg-4 col-md-6 col-12">${productComponent(e.id,e.slug,e.product_name,e.brand,e.images)}</div>`}),c=t.count?Math.ceil(t.count/12):0,c?s.html(o).removeClass("load"):s.html(""),r?(e=1,paginateController(c,null,e)):$("html, body").animate({scrollTop:s.offset().top-130},"slow"),$(".search_count").html(t.count)},error:function(e){console.error(e)},complete:function(){$(".disabled-auto").prop("disabled",!1).removeClass("disabled-auto")}})};n(i,{keyword:e,filt_brands:t,filt_group:r,filt_categories:o,filt_2nd_categories:a},!0),$db.on("click",'[data-role="pagination"] a:not([disabled])',function(){i=paginateController(c,$(this)),filter_url([{page:i+""},{keyword:e},{group:r},{brands:t},{categories:o},{"second-categories":a}]),n(i,{keyword:e,filt_brands:t,filt_group:r,filt_categories:o,filt_2nd_categories:a})}),$db.on("keypress",'[data-role="product-search"]',function(l){13==l.which&&(e=$(this).val(),i="",filter_url([{page:i},{keyword:e},{group:r},{brands:t},{categories:o},{"second-categories":a}]),n(i,{keyword:e,filt_brands:t,filt_group:r,filt_categories:o,filt_2nd_categories:a},!0))}),$db.on("click",'[data-role="filter-products"]',function(){i=1,filter_url([{page:i},{keyword:e},{group:r},{brands:t},{categories:o},{"second-categories":a}]),n(i,{keyword:e,filt_brands:t,filt_group:r,filt_categories:o,filt_2nd_categories:a},!0),$("html, body").animate({scrollTop:s.offset().top-130},"slow")});let f=(e,t)=>{let r=e.data("val")+"";if(t){t+="";let o=t.split(",");e.is(":checked")?o.push(r):o=filterList(o,r),o=o?o.filter(array_unique):[],t=o.join(",")}else t=e.is(":checked")?r:"";return t};$db.on("change",'[data-role="filter-brand-list"] input[type="checkbox"]',function(){t=f($(this),t),i="",filter_url([{page:i},{keyword:e},{group:r},{brands:t},{categories:o},{"second-categories":a}]),n(i,{keyword:e,filt_brands:t,filt_group:r,filt_categories:o,filt_2nd_categories:a},!0)}),$db.on("change",'[data-role="filter-category-list"] input[type="checkbox"]',function(){o=f($(this),o),i="",filter_url([{page:i},{keyword:e},{group:r},{brands:t},{categories:o},{"second-categories":a}]),n(i,{keyword:e,filt_brands:t,filt_group:r,filt_categories:o,filt_2nd_categories:a},!0)}),$db.on("change",'[data-role="filter-second-category-list"] input[type="checkbox"]',function(){a=f($(this),a),i="",filter_url([{page:i},{keyword:e},{group:r},{brands:t},{categories:o},{"second-categories":a}]),n(i,{keyword:e,filt_brands:t,filt_group:r,filt_categories:o,filt_2nd_categories:a},!0)})});